trigger:
  - master

resources:
  - repo: self

variables:
  tag: ubuntu18.04cuda9.2
  dockerId: simogasp  # your Docker ID for Docker Hub
  imageName: eesep-dependencies  # the name of the image you want to publish

stages:
  - stage: Build
    displayName: Build image
    jobs:
    - job: Build
      displayName: Build
      pool:
        vmImage: 'ubuntu-latest'
      steps:
      - task: Docker@2
        displayName: Login to Docker Hub
        inputs:
          command: login
          containerRegistry: dockerHub
      - task: Docker@2
        displayName: Build
        inputs:
         command: build
         #arguments: --build-arg NPROC=2
         repository: $(dockerId)/$(imageName)
         tags: |
           $(tag)
      - task: Docker@2
        displayName: Push
        inputs:
         command: push
         repository: $(dockerId)/$(imageName)
         tags: |
           $(tag)